; PlatformIO configuration for nextbus-esp32-ink
; See: https://docs.platformio.org/page/projectconf.html

[platformio]
default_envs = esp32c3

; --- Seeed XIAO ESP32-C3 + ePaper Driver Board V2 ---
[env:esp32c3]
platform = espressif32
board = seeed_xiao_esp32c3
framework = arduino
monitor_speed = 115200
lib_deps =
    bblanchon/ArduinoJson@^7
    zinggjm/GxEPD2@^1
build_flags =
    -DDEBUG
    -DARDUINO_USB_CDC_ON_BOOT=1
; XIAO ESP32-C3 USB-CDC doesn't support auto-reset.
; Enter bootloader manually: hold BOOT, press RESET, release BOOT.
; The board appears on a different COM port in bootloader mode.
upload_speed = 460800
upload_flags =
    --before
    no_reset
    --after
    hard_reset

; --- Native host build (for unit & integration tests) ---
[env:native]
platform = native
lib_deps =
    bblanchon/ArduinoJson@^7
build_flags = -std=c++17
test_build_src = true
build_src_filter = +<model.cpp>
